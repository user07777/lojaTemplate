<head>
    <title>loja</title>
    <link href="styles.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@200..800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.2.2/axios.min.js"></script>


</head>
<body>
<div id="site">


    <div class="banner">
        
        <div class="wrapper">
            <div class="searchBar">
              <input id="searchQueryInput" type="text" name="searchQueryInput" placeholder="Search" value="" />
              <button id="searchQuerySubmit" type="submit" name="searchQuerySubmit" @click="message()" >
                <svg style="width:24px;height:24px" viewBox="0 0 24 24"><path fill="#666666" d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" />
                </svg>
              </button>
            </div>
          </div>

        <h1>LojaTeste</h1>
        
        <svg id="cart"  v-on:click="profile=false;main=false;cart=true"  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="#ffffff" d="M0 24C0 10.7 10.7 0 24 0L69.5 0c22 0 41.5 12.8 50.6 32l411 0c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3l-288.5 0 5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5L488 336c13.3 0 24 10.7 24 24s-10.7 24-24 24l-288.3 0c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5L24 48C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/></svg>
        
        <div class="usr">
            <svg v-if="logged"  v-on:click="profile=true;main=false;cart=false" id="user" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="#ffffff" d="M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512l388.6 0c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304l-91.4 0z"/></svg>
            <svg v-else v-on:click="registerPage=true;main=false;profile=false;cart=false" id="user" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="#ffffff" d="M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512l388.6 0c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304l-91.4 0z"/></svg>
            <svg v-if="logged" v-on:click="javascript:window.location.href='/logout'" id="exit" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="#ffffff" d="M377.9 105.9L500.7 228.7c7.2 7.2 11.3 17.1 11.3 27.3s-4.1 20.1-11.3 27.3L377.9 406.1c-6.4 6.4-15 9.9-24 9.9c-18.7 0-33.9-15.2-33.9-33.9l0-62.1-128 0c-17.7 0-32-14.3-32-32l0-64c0-17.7 14.3-32 32-32l128 0 0-62.1c0-18.7 15.2-33.9 33.9-33.9c9 0 17.6 3.6 24 9.9zM160 96L96 96c-17.7 0-32 14.3-32 32l0 256c0 17.7 14.3 32 32 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-64 0c-53 0-96-43-96-96L0 128C0 75 43 32 96 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32z"/></svg>
        </div>
    </div>
    <div class="dropbanner">
        <h2 v-on:click="javascript:window.location.href='/ctt'" >Contato</h2>
        <h2 v-on:click="javascript:window.location.href='/'" >Home</h2>
        <h2 v-on:click="javascript:window.location.href='/about'" >Sobre n√≥s</h2>
    </div>

    <iframe class= "register" v-if="registerPage && !logged" src="/register"></iframe>

    <iframe class= "register" v-if="profile && logged" src="/profile"></iframe>

    <iframe ref="produtos" id ="prodsu" class= "register" v-if="main && !profile  " src="/products"></iframe>

    <div class="cart cart2" v-if="cart">
        <div class="cart-empty-container" v-if="window.cartData.length == 0">
            <img src="https://www.99fashionbrands.com/wp-content/uploads/2020/12/empty_cart.png" >
        </div>

        <div class="cartProduct" v-for="i in window.cartData">
            <img :src="i.product.img" alt="imagem">
            <div style="display:block">
                <h2>{{i.product.name}}</h2>
                <h2>{{i.product.price}}</h2>
            </div>
        </div>
        <button class="buy" @click="window.alert('comprado!')"  v-if="window.cartData.length != 0">Comprar</button>
    </div>
    
</div>
</body>
<script>
     Vue.config.devtools = true

     window.cartData = [];
     a = 
     new Vue({
        el: "#site",
        data:{
            user:{
                name:"admin"
            },
            logged:false,
            registerPage:false,
            profile:false,
            main:true,
            cart:false,
            cartData:[],
            search:''
        },
        mounted () {
            setInterval(() => {
                if (this.hasCookie("tkn")) {
                    this.logged = true;
                }     
            }, 1000);
            window.addEventListener('message', function(e) {
                if (e.data && e.data.cart) {
                    window.cartData = e.data.cart;
                    console.log(window.cartData);
                }
            });
        },
        methods: {
            hasCookie(name) {
                const value = `; ${document.cookie}`;
                const parts = value.split(`; ${name}=`);
                if (parts.length === 2) return parts.pop().split(';').shift();
                return null;
            },
            message() {
                const iframe = this.$refs.produtos.contentWindow;
                val = document.getElementById("searchQueryInput").value;
                iframe.postMessage(val,"*");
            }
        }
    })
window.onscroll = function() {
    if (window.pageYOffset > 0) {
        document.getElementsByClassName("banner")[0].style.position = "fixed";
        document.getElementsByClassName("banner")[0].style.top = "0px";
        document.getElementsByClassName("banner")[0].style.zIndex = "5"; 
    } else {
        document.getElementsByClassName("banner")[0].style.position = "relative";
        document.getElementsByClassName("banner")[0].style.zIndex = "0";
    }
};
</script>